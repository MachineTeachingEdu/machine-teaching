{% extends "questions/base.html" %}
{% load static %}
{% load i18n %}

{% block content %}
<h2>{% trans "Chapter" %} <span id="aula"></span></h2>
<table id="problems" class="chapters">
    <thead>
    <tr>
        <th class="searchable">{% trans "Chapter" %}</th>
        <th class="searchable">{% trans "Problem" %}</th>
        <th class="searchable">{% trans "Outcome" %}</th>
    </tr>
    </thead>

    <tbody>
    {% for item in problems %}
    <tr>
        <td>{{ item.chapter }}</td>
        <td><a href={% url 'show_problem' problem_id=item.id %}>{{ item.title }}</a></td>
        <td>{% if item.id in passed %}<span class="passed">{% trans "Passed" %}</span>{% else %}
            {% if item.id in skipped %}<span class="skipped">{% trans "Skipped" %}</span>{% endif %}
            {% if item.id in failed %}<span class="failed">{% trans "Failed" %}</span>{% endif %}
            {% endif %}</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}
{% block javascript %}
<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script>
    $(document).ready(function() {
        var table = $('#problems').DataTable({
            "pageLength": 50,
            "order": [[ 0, "desc" ]],
            {% get_current_language as language %}
            {% if language == 'pt-br' %}
            "language": {
                    "sEmptyTable": "Nenhum registro encontrado",
                    "sInfo": "Mostrando de _START_ até _END_ de _TOTAL_ registros",
                    "sInfoEmpty": "Mostrando 0 até 0 de 0 registros",
                    "sInfoFiltered": "(Filtrados de _MAX_ registros)",
                    "sInfoPostFix": "",
                    "sInfoThousands": ".",
                    "sLengthMenu": "mostrar_MENU_ por página",
                    "sLoadingRecords": "Carregando...",
                    "sProcessing": "Processando...",
                    "sZeroRecords": "Nenhum registro encontrado",
                    "sSearch": "Pesquisar",
                    "oPaginate": {
                        "sNext": "Próximo",
                        "sPrevious": "Anterior",
                        "sFirst": "Primeiro",
                        "sLast": "Último"
                    }
                }
            {% endif %}
        });

        $("#aula").each( function ( i ) {
            var select = $('<select><option value="">Todas</option></select>')
                .appendTo( $(this).empty() )
                .on( 'change', function () {
                    table.column( i )
                        .search( $(this).val() )
                        .draw();
                } );

            table.column( i ).data().unique().sort().each( function ( d, j ) {
                select.append( '<option value="'+d+'">'+d+'</option>' )
            } );
        } );
    } );
</script>
{% endblock %}
